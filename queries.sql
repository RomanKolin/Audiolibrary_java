SELECT cat, noorigartsbands, nosongs, REPLACE(REPLACE(songsdur, ':0', ':'), '00:', '0:') FROM `Audio library` WHERE cat='Жанр' UNION (SELECT cat, noorigartsbands, nosongs, REPLACE(REPLACE(songsdur, ':0', ':'), '00:', '0:') FROM `Audio library` WHERE cat='Композиторы') UNION (SELECT cat, noorigartsbands, nosongs, REPLACE(REPLACE(songsdur, ':0', ':'), '00:', '0:') FROM `Audio library` WHERE cat='Блогеры') UNION (SELECT cat, noorigartsbands, nosongs, REPLACE(REPLACE(songsdur, ':0', ':'), '00:', '0:') FROM `Audio library` WHERE cat='Каверы') UNION (SELECT cat, noorigartsbands, nosongs, REPLACE(REPLACE(songsdur, ':0', ':'), '00:', '0:') FROM `Audio library` WHERE cat='Саундтреки');
SELECT nam, noartsbands, nosongs, REPLACE(songsdur, ':0', ':') FROM Genre ORDER BY nam;
WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр') SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))), ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband;
WITH relmusicartistband AS(SELECT `Related music artist/band`.relartband, Song.nam, `Related music artist/band`.nosongs, `Related music artist/band`.songsdur, `Related music artist/band`.ID FROM `Music artist/band` JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Related music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.ID=?) SELECT relartband, GROUP_CONCAT(DISTINCT nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM relmusicartistband GROUP BY relartband, nosongs, songsdur, ID ORDER BY relartband;
WITH composer AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Композиторы') SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM composer GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH blogger AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Блогеры') SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM blogger GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
SELECT Song.nam, TRIM(LEADING '00:' FROM REPLACE(Song.dur, ':0', ':')), `Music artist/band's song`.feat, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band's song`.artband=? AND Song.cat IS NULL ORDER BY Song.nam;
SELECT Song.nam, TRIM(LEADING '00:' FROM REPLACE(Song.dur, ':0', ':')), `Music artist/band's song`.feat, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band's song`.artband=? AND Song.cat IS NULL ORDER BY Song.nam;
WITH cover AS(WITH cover AS(SELECT Song.nam, `Music artist/band`.artband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' UNION (SELECT Song.nam, `Related music artist/band`.relartband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы')) SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Music artist/band`.artband AS origartband, `Cover's original music artist/band`.feat AS origfeat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Music artist/band` ON `Cover's original music artist/band`.artband=`Music artist/band`.ID UNION (SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Related music artist/band`.relartband, `Cover's original music artist/band`.feat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Related music artist/band` ON `Cover's original music artist/band`.artband=`Related music artist/band`.ID)) SELECT nam, artband, feat, TRIM(LEADING '00:' FROM REPLACE(dur, ':0', ':')), GROUP_CONCAT(origartband SEPARATOR ', '), GROUP_CONCAT(DISTINCT origfeat SEPARATOR ''), ID FROM cover GROUP BY artband, nam, feat, dur, ID ORDER BY nam, artband;
SELECT movanimsergam, artband, song, nosongs, TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':')), ID FROM Soundtrack ORDER BY movanimsergam;
WITH favourites AS(WITH favourites AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, Favourites.num FROM `Music artist/band` JOIN Favourites ON `Music artist/band`.ID=Favourites.artband LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр') SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, num FROM favourites GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, num) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))), num FROM favourites GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, num ORDER BY num;

INSERT INTO `Music artist/band`(artband, genr, cat) VALUES(?, ?, 'Жанр');
INSERT INTO `Related music artist/band`(relartband, artband) VALUES(?, ?);
INSERT INTO Song(nam, dur, cat) VALUES(?, ?, null);
INSERT INTO `Music artist/band's song`(song, artband, feat) VALUES(?, ?, ?);
UPDATE `Music artist/band` SET artband=?, genr=? WHERE ID=?;
UPDATE `Related music artist/band` SET relartband=?, artband=? WHERE ID=?;
UPDATE Song SET nam=?, dur=?, feat=? WHERE ID=?;
DELETE FROM `Music artist/band's song` WHERE song=?;
INSERT INTO `Music artist/band`(artband, cat) VALUES(?, 'Композиторы');
UPDATE `Music artist/band` SET artband=? WHERE ID=?;
INSERT INTO `Music artist/band`(artband, cat) VALUES(?, 'Блогеры');
UPDATE `Music artist/band` SET artband=? WHERE ID=?;
INSERT INTO Song(nam, dur, cat) VALUES(?, ?, 'Каверы');
INSERT INTO `Music artist/band's song`(song, artband, feat) VALUES(?, ?, ?);
INSERT INTO `Cover's original music artist/band`(song, artband, feat) VALUES(?, ?, ?);
INSERT INTO Soundtrack(movanimsergam, artband, song, nosongs, songsdur, cat) VALUES(?, ?, ?, ?, ?, 'Саундтреки');
UPDATE Soundtrack SET movanimsergam=?, artband=?, song=?, nosongs=?, songsdur=? WHERE ID=?;

WITH musicartistband AS((WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр' AND `Music artist/band`.artband LIKE ?) SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', ') AS nam, nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))) AS songsdur, totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))) AS totsongsdur, ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband) UNION (WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр' AND `Related music artist/band`.relartband LIKE ?) SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', ') AS nam, nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))) AS songsdur, totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))) AS totsongsdur, ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband)) SELECT artband, relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband ORDER BY artband;
WITH composer AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Композиторы' AND `Music artist/band`.artband LIKE ?) SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM composer GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH blogger AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Блогеры' AND `Music artist/band`.artband LIKE ?) SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM blogger GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH cover AS((WITH cover AS(WITH cover AS(SELECT Song.nam, `Music artist/band`.artband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' AND Song.nam LIKE ? UNION (SELECT Song.nam, `Related music artist/band`.relartband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' AND Song.nam LIKE ?)) SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Music artist/band`.artband AS origartband, `Cover's original music artist/band`.feat AS origfeat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Music artist/band` ON `Cover's original music artist/band`.artband=`Music artist/band`.ID UNION (SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Related music artist/band`.relartband, `Cover's original music artist/band`.feat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Related music artist/band` ON `Cover's original music artist/band`.artband=`Related music artist/band`.ID)) SELECT nam, artband, feat, TRIM(LEADING '00:' FROM REPLACE(dur, ':0', ':')) AS dur, GROUP_CONCAT(origartband SEPARATOR ', ') AS origartband, GROUP_CONCAT(DISTINCT origfeat SEPARATOR '') AS origfeat, ID FROM cover GROUP BY artband, nam, feat, dur, ID ORDER BY nam, artband) UNION (WITH cover AS(WITH cover AS(SELECT Song.nam, `Music artist/band`.artband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' AND `Music artist/band`.artband LIKE ? UNION (SELECT Song.nam, `Related music artist/band`.relartband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' AND `Related music artist/band`.relartband LIKE ?)) SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Music artist/band`.artband AS origartband, `Cover's original music artist/band`.feat AS origfeat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Music artist/band` ON `Cover's original music artist/band`.artband=`Music artist/band`.ID UNION (SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Related music artist/band`.relartband, `Cover's original music artist/band`.feat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Related music artist/band` ON `Cover's original music artist/band`.artband=`Related music artist/band`.ID)) SELECT nam, artband, feat, TRIM(LEADING '00:' FROM REPLACE(dur, ':0', ':')) AS dur, GROUP_CONCAT(origartband SEPARATOR ', ') AS origartband, GROUP_CONCAT(DISTINCT origfeat SEPARATOR '') AS origfeat, ID FROM cover GROUP BY artband, nam, feat, dur, ID ORDER BY nam, artband) UNION (WITH cover AS(WITH cover AS(SELECT Song.nam, `Music artist/band`.artband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' UNION (SELECT Song.nam, `Related music artist/band`.relartband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы')) SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Music artist/band`.artband AS origartband, `Cover's original music artist/band`.feat AS origfeat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Music artist/band` ON `Cover's original music artist/band`.artband=`Music artist/band`.ID WHERE `Music artist/band`.artband LIKE ? UNION (SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Related music artist/band`.relartband, `Cover's original music artist/band`.feat, cover.ID FROM cover LEFT JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song LEFT JOIN `Related music artist/band` ON `Cover's original music artist/band`.artband=`Related music artist/band`.ID WHERE `Related music artist/band`.relartband LIKE ?)) SELECT nam, artband, feat, TRIM(LEADING '00:' FROM REPLACE(dur, ':0', ':')) AS dur, GROUP_CONCAT(origartband SEPARATOR ', ') AS origartband, GROUP_CONCAT(DISTINCT origfeat SEPARATOR '') AS origfeat, ID FROM cover GROUP BY artband, nam, feat, dur, ID ORDER BY nam, artband)) SELECT nam, artband, feat, dur, origartband, origfeat, ID FROM cover ORDER BY nam;
WITH soundtrack AS((SELECT movanimsergam, artband, song, nosongs, TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':')) AS songsdur, ID FROM Soundtrack WHERE movanimsergam LIKE ? ORDER BY movanimsergam) UNION (SELECT movanimsergam, artband, song, nosongs, TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':')) AS songsdur, ID FROM Soundtrack WHERE artband LIKE ? ORDER BY movanimsergam) UNION (SELECT movanimsergam, artband, song, nosongs, TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':')) AS songsdur, ID FROM Soundtrack WHERE song LIKE ? ORDER BY movanimsergam)) SELECT movanimsergam, artband, song, nosongs, songsdur, ID FROM soundtrack ORDER BY movanimsergam;
SELECT Song.nam, TRIM(LEADING '00:' FROM REPLACE(Song.dur, ':0', ':')), `Music artist/band's song`.feat, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band's song`.artband=? AND Song.cat IS NULL AND Song.nam LIKE ? ORDER BY Song.nam;
SELECT Song.nam, TRIM(LEADING '00:' FROM REPLACE(Song.dur, ':0', ':')), `Music artist/band's song`.feat, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band's song`.artband=? AND Song.cat IS NULL AND Song.nam LIKE ? ORDER BY Song.nam;

WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр' AND `Music artist/band`.genr=?) SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))), ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband;
WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр' AND `Related music artist/band`.relartband IS ?) SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))), ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband;
WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр' AND `Music artist/band`.totnosongs BETWEEN ? AND ?) SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))), ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband;
WITH musicartistband AS(WITH musicartistband AS(SELECT `Music artist/band`.artband, `Related music artist/band`.relartband, `Music artist/band`.genr, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.totnosongs, `Music artist/band`.totsongsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Related music artist/band` ON `Music artist/band`.ID=`Related music artist/band`.artband LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Жанр' AND `Music artist/band`.totsongsdur BETWEEN CAST(? AS TIME) AND CAST(? AS TIME)) SELECT artband, GROUP_CONCAT(DISTINCT relartband SEPARATOR ', ') AS relartband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID FROM musicartistband GROUP BY artband, genr, nam, nosongs, songsdur, totnosongs, totsongsdur, ID) SELECT artband, relartband, genr, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), totnosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(totsongsdur, ':0', ':'))), ID FROM musicartistband GROUP BY artband, relartband, genr, nosongs, songsdur, totnosongs, totsongsdur, ID ORDER BY artband;
WITH composer AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Композиторы' AND `Music artist/band`.nosongs BETWEEN ? AND ?) SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM composer GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH composer AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Композиторы' AND `Music artist/band`.songsdur BETWEEN CAST(? AS TIME) AND CAST(? AS TIME)) SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM composer GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH blogger AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Блогеры' AND `Music artist/band`.nosongs BETWEEN ? AND ?) SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM blogger GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH blogger AS(SELECT `Music artist/band`.artband, Song.nam, `Music artist/band`.nosongs, `Music artist/band`.songsdur, `Music artist/band`.ID FROM `Music artist/band` LEFT JOIN `Music artist/band's song` ON `Music artist/band`.ID=`Music artist/band's song`.artband LEFT JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE `Music artist/band`.cat='Блогеры' AND `Music artist/band`.songsdur BETWEEN CAST(? AS TIME) AND CAST(? AS TIME)) SELECT artband, GROUP_CONCAT(nam ORDER BY nam SEPARATOR ', '), nosongs, TRIM(LEADING '0' FROM TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':'))), ID FROM blogger GROUP BY artband, nosongs, songsdur, ID ORDER BY artband;
WITH cover AS(WITH cover AS(SELECT Song.nam, `Music artist/band`.artband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Music artist/band` ON `Music artist/band's song`.artband=`Music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' AND Song.dur BETWEEN CAST(? AS TIME) AND CAST(? AS TIME) UNION (SELECT Song.nam, `Related music artist/band`.relartband, `Music artist/band's song`.feat, Song.dur, Song.ID FROM `Music artist/band's song` JOIN `Related music artist/band` ON `Music artist/band's song`.artband=`Related music artist/band`.ID JOIN Song ON `Music artist/band's song`.song=Song.ID WHERE Song.cat='Каверы' AND Song.dur BETWEEN CAST(? AS TIME) AND CAST(? AS TIME))) SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Music artist/band`.artband AS origartband, `Cover's original music artist/band`.feat AS origfeat, cover.ID FROM cover JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song JOIN `Music artist/band` ON `Cover's original music artist/band`.artband=`Music artist/band`.ID UNION (SELECT cover.nam, cover.artband, cover.feat, cover.dur, `Related music artist/band`.relartband, `Cover's original music artist/band`.feat, cover.ID FROM cover JOIN `Cover's original music artist/band` ON cover.ID=`Cover's original music artist/band`.song JOIN `Related music artist/band` ON `Cover's original music artist/band`.artband=`Related music artist/band`.ID)) SELECT nam, artband, feat, TRIM(LEADING '00:' FROM REPLACE(dur, ':0', ':')), GROUP_CONCAT(origartband SEPARATOR ', '), origfeat, ID FROM cover GROUP BY artband, nam, feat, dur, origfeat, ID ORDER BY nam, artband;
SELECT movanimsergam, artband, song, nosongs, TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':')), ID FROM Soundtrack WHERE Soundtrack.nosongs BETWEEN ? AND ? ORDER BY movanimsergam;
SELECT movanimsergam, artband, song, nosongs, TRIM(LEADING '00:' FROM REPLACE(songsdur, ':0', ':')), ID FROM Soundtrack WHERE Soundtrack.songsdur BETWEEN CAST(? AS TIME) AND CAST(? AS TIME) ORDER BY movanimsergam;

SELECT * FROM TotalSongsStatisticsVIEW;
CALL SongsStatisticsTotalGenre();
CALL SongsStatisticsGenre(?);
CALL SongsStatisticsComposers();
CALL SongsStatisticsBloggers();
CALL SongsStatisticsCovers();
CALL SongsStatisticsSoundtracks();